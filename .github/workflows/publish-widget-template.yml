      - name: Bump composer version
        working-directory: ${{ inputs.widget-path }}
        run: composer config version "${{ inputs.version }}"

      - name: Commit version bump & tag
        working-directory: ${{ inputs.widget-path }}
        run: |
          NAME=$(basename "${{ inputs.widget-path }}")
          git add "${{ inputs.widget-path }}/composer.json"
          git commit -m "chore: bump $NAME to v${{ inputs.version }}"
          git tag "$NAME-v${{ inputs.version }}"

      - name: Push to monorepo (no tags)
        run: git push origin HEAD:main --no-tags

      - name: Split subtree
        run: |
          NAME=$(basename "${{ inputs.widget-path }}")
          BR="release/$NAME"
          git subtree split --prefix="${{ inputs.widget-path }}" -b "$BR"

      - name: Push subtree to widget repo
        run: |
          NAME=$(basename "${{ inputs.widget-path }}")
          BR="release/$NAME"
          REPO="https://github.com/WeAreHausTech/$NAME.git"
          git push "$REPO" "$BR:main" --tags
